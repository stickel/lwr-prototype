<template>
    <setup-page-header
        header-icon="utility:settings"
        page-title="Sales Cloud for Slack">
    </setup-page-header>

    <!-- page content -->
    <div class="setupcontent">
        <lightning-card>
            <header slot="title">
                <lightning-layout
                    horizontal-align="spread">
                    <lightning-layout-item>
                        <h2 class="slds-text-heading_medium">
                            Sales Cloud for Slack App
                        </h2>
                    </lightning-layout-item>
                </lightning-layout>
            </header>
            <div slot="actions">
                <lightning-input
                    class="header-toggle"
                    type="toggle"
                    label="Enable Slack App"
                    message-toggle-active="On"
                    message-toggle-inactive="Off"
                    variant="label-hidden"
                    onchange={handleEnableSlack}>
                </lightning-input>
            </div>
            <div class="container slds-p-horizontal_medium slds-p-bottom_large">
                <p>Let sales reps and managers connect to Salesforce from the Sales Cloud for Slack app. Users also need to get the app in Slack.</p>
                <template if:true={slackEnabled}>
                    <div class="slds-m-top_x-large slds-card slds-card__body_inner slds-card_boundary slds-p-around_small permission-set-block">
                        <div class="slds-card__header slds-m-bottom_none">
                            <div class="slds-media slds-grid slds-grid_align-spread">
                                <div class="slds-media__body">
                                    <h3 class="slds-card__header-title slds-text-heading_small slds-m-bottom_small">
                                        Some type of header content
                                    </h3>
                                </div>
                                <div class="slds-no-flex">
                                    <lightning-button
                                        label="Manage Permission Set"
                                        variant="neutral">
                                    </lightning-button>
                                </div>
                            </div>
                        </div>
                        <div class="slds-card__body slds-card__body_inner slds-m-top_none">
                            <p>A brief, fun description of the thing you can do here.</p>
                        </div>
                    </div>
                </template>
            </div>
        </lightning-card>
        <template if:true={slackEnabled}>
            <lightning-card class="slack-onboarding">
                <header slot="title">
                    <h2 class="slds-text-heading_medium">Set Up Sales Channels</h2>
                </header>
                <div class="slds-p-horizontal_medium slds-p-bottom_large">
                    <p>Users can link a Salesforce opportunity or account to a Slack channel. Channel members can collaborate on the records easily and get notifications about the records in Slack.</p>
                    <div class="slds-box slds-m-top_medium slds-p-top_small slds-p-left_small slds-p-right_small">
                        <h3 class="slds-card__header-title slds-text-heading_small slds-m-bottom_small">
                            Manage Who Can Create Sales Channels
                            <lightning-helptext 
                                class="slds-m-left_x-small sales-help"
                                content="Select the level of record access required to link records to Slack channels.">
                            </lightning-helptext>
                        </h3>
                        <setup-radio-group-with-hint
                            class="slds-m-bottom_medium"
                            label="Manage Who Can Create Sales Channels"
                            options={salesChannelAccessOptions}
                            value={salesChannelAccessValue}
                            variant="label-hidden"
                            onchange={handleSalesChannelAccessChange}>
                        </setup-radio-group-with-hint>
                        <!-- <lightning-radio-group
                            name="access"
                            class="slds-m-bottom_medium"
                            label="Manage Who Can Create Sales Channels"
                            options={salesChannelAccessOptions}
                            value={salesChannelAccessValue}
                            variant="label-hidden"
                            onchange={handleSalesChannelAccessChange}>
                        </lightning-radio-group> -->
                    </div>
                </div>
            </lightning-card>
            <lightning-card class="slack-onboarding">
                <header slot="title">
                    <h2 class="slds-text-heading_medium">Set Up Feed Channels</h2>
                </header>
                <div class="slds-p-horizontal_medium slds-p-bottom_large">
                    <p>Activate feed channels and add users to them. Users see these channels in Slack when they add Sales Cloud for Slack.</p>
                    <div class="slds-box slds-m-top_medium slds-p-top_small slds-p-left_small slds-p-right_small">
                        <div class="slds-media slds-grid slds-grid_align-spread slds-p-bottom_medium">
                            <div class="slds-media__body">
                                <h3 class="slds-card__header-title slds-text-heading_small slds-m-bottom_small">
                                    Feed Channels
                                </h3>
                                <p class="slds-col slds-size_3-of-4">Feed channels help your team stay current with your company's deals.</p>
                            </div>
                            <div class="slds-media__figure slds-m-right_none">
                                <lightning-button
                                    label="Select Feed Channels"
                                    variant="neutral"
                                    onclick={handleSelectBroadcastChannels}>
                                </lightning-button>
                            </div>
                        </div>
                        <ul if:true={hasChannels}>
                            <template for:each={broadcastChannels} for:item="channel">
                                <template if:true={channel.active}>
                                    <li class="slds-media slds-border_top slds-p-top_medium slds-p-bottom_medium"
                                        key={channel.id}>
                                        <div class="slds-media__body slds-grid slds-grid_vertical">
                                            <p class="slds-m-bottom_small channel-name">
                                                {channel.name} 
                                                <a class="slds-p-left_small channel-name_link"
                                                    href="javascript:void(0)"
                                                    data-channel-id={channel.id}
                                                    onclick={handleOpenSlackChannel}>View channel in Slack</a>
                                            </p>
                                            <p class="slds-col slds-size_3-of-4">{channel.topic}</p>
                                        </div>
                                        <div class="slds-media__figure slds-m-right_none">
                                            <lightning-button
                                                label="View Channel Details"
                                                icon-name="utility:check"
                                                variant="neutral"
                                                onclick={handleViewChannelDetails}>
                                            </lightning-button>
                                        </div>
                                    </li>
                                </template>
                                <template if:false={channel.active}>
                                    <li class="slds-media slds-border_top slds-p-top_medium slds-p-bottom_medium"
                                        key={channel.id}>
                                        <div class="slds-media__body slds-grid slds-grid_vertical">
                                            <p class="slds-m-bottom_small channel-name">
                                                {channel.name}
                                            </p>
                                            <p class="slds-col slds-size_3-of-4">{channel.topic}</p>
                                        </div>
                                        <div class="slds-media__figure slds-m-right_none">
                                            <lightning-button
                                                label="Activate Channel"
                                                data-id={channel.id}
                                                variant="brand"
                                                onclick={handleViewAndActivateChannel}>
                                            </lightning-button>
                                        </div>
                                    </li>
                                </template>
                            </template>
                        </ul>
                    </div>
                </div>
            </lightning-card>
        </template>
    </div>
    <!-- /END page content -->
</template>